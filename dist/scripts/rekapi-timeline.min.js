!function(){define("rekapi-timeline.component.container/model",["lateralus"],function(a){"use strict";var b=a.Component.Model,c=b.prototype,d=b.extend({initialize:function(){c.initialize.apply(this,arguments)}});return d}),define("text",{load:function(a){throw new Error("Dynamic load not allowed: "+a)}}),define("text!rekapi-timeline.component.container/template.mustache",[],function(){return'<div class="$controlBar"></div>\n<div class="$timeline fill"></div>\n<div class="$details"></div>\n<div class="$scrubberDetail"></div>\n'}),define("rekapi-timeline/constant",[],function(){"use strict";var a={PIXELS_PER_SECOND:300,NEW_KEYFRAME_PROPERTY_BUFFER_MS:500,DEFAULT_TIMELINE_SCALE:1};return a}),define("rekapi-timeline.component.container/view",["lateralus","text!./template.mustache","rekapi-timeline/constant"],function(a,b,c){"use strict";var d=a.Component.View,e=d.prototype,f=d.extend({template:b,provide:{timelineMillisecondForHandle:function(a){var b=parseInt(a.css("left"),10)-parseInt(a.parent().css("border-left-width"),10),d=b/c.PIXELS_PER_SECOND*1e3;return d/this.lateralus.model.get("timelineScale")}},initialize:function(){e.initialize.apply(this,arguments)}});return f}),define("rekapi-timeline.component.control-bar/model",["lateralus"],function(a){"use strict";var b=a.Component.Model,c=b.prototype,d=b.extend({initialize:function(){c.initialize.apply(this,arguments)}});return d}),define("text!rekapi-timeline.component.control-bar/template.mustache",[],function(){return'<button class="icon-button play">\n  <i class="glyphicon glyphicon-play"></i>\n</button>\n<button class="icon-button pause">\n  <i class="glyphicon glyphicon-pause"></i>\n</button>\n<button class="icon-button stop">\n  <i class="glyphicon glyphicon-stop"></i>\n</button>\n'}),define("rekapi-timeline.component.control-bar/view",["lateralus","text!./template.mustache"],function(a,b){"use strict";var c=a.Component.View,d=c.prototype,e=c.extend({template:b,lateralusEvents:{"rekapi:playStateChange":function(){this.lateralus.rekapi.isPlaying()?this.$el.addClass("playing"):this.$el.removeClass("playing")}},events:{"click .play":function(){this.play()},"click .pause":function(){this.pause()},"click .stop":function(){this.emit("stopAnimation")}},initialize:function(){d.initialize.apply(this,arguments),this.lateralus.isPlaying()&&this.$el.addClass("playing")},play:function(){this.lateralus.playFromCurrent()},pause:function(){this.lateralus.pause()}});return e}),define("rekapi-timeline.component.control-bar/main",["lateralus","./model","./view","text!./template.mustache"],function(a,b,c,d){"use strict";var e=a.Component,f=e.extend({name:"control-bar",Model:b,View:c,template:d});return f}),define("rekapi-timeline.component.control-bar",["rekapi-timeline.component.control-bar/main"],function(a){return a}),define("rekapi-timeline.component.timeline/model",["lateralus"],function(a){"use strict";var b=a.Component.Model,c=b.prototype,d=b.extend({initialize:function(){c.initialize.apply(this,arguments)}});return d}),define("text!rekapi-timeline.component.timeline/template.mustache",[],function(){return'<div class="$timelineWrapper timeline-wrapper">\n  <div class="$scrubber"></div>\n  <div class="$animationTracks"></div>\n</div>\n'}),define("rekapi-timeline.component.timeline/view",["lateralus","text!./template.mustache","rekapi-timeline/constant"],function(a,b,c){"use strict";var d=a.Component.View,e=d.prototype,f=d.extend({template:b,lateralusEvents:{"change:timelineDuration":function(){this.updateWrapperWidth()}},provide:{timelineWrapperHeight:function(){return this.$timelineWrapper.height()}},initialize:function(){e.initialize.apply(this,arguments),this.updateWrapperWidth()},getPixelWidthForTracks:function(){var a=this.lateralus.model.get("timelineDuration"),b=a/1e3;return c.PIXELS_PER_SECOND*b+this.$el.width()},updateWrapperWidth:function(){this.$timelineWrapper.css("width",this.getPixelWidthForTracks())}});return f}),define("rekapi-timeline.component.scrubber/model",["lateralus"],function(a){"use strict";var b=a.Component.Model,c=b.prototype,d=b.extend({initialize:function(){c.initialize.apply(this,arguments)}});return d}),define("text!rekapi-timeline.component.scrubber/template.mustache",[],function(){return'<div class="$scrubberWrapper scrubber-wrapper">\n  <div class="$scrubberHandle scrubber-handle">\n    <i class="glyphicon glyphicon-chevron-down scrubber-icon">&nbsp;</i>\n    <figure class="$scrubberGuide scrubber-guide"></figure>\n  </div>\n</div>\n'}),define("rekapi-timeline.component.scrubber/view",["lateralus","text!./template.mustache","rekapi-timeline/constant"],function(a,b,c){"use strict";var d=a.Component.View,e=d.prototype,f=d.extend({template:b,lateralusEvents:{"change:timelineScale":function(){this.render()},"change:timelineDuration":function(){this.render()},"rekapi:afterUpdate":function(){this.render()},"rekapi:addKeyframePropertyTrack":function(){this.resizeScrubberGuide()}},events:{"drag .scrubber-handle":function(){var a=this.collectOne("timelineMillisecondForHandle",this.$scrubberHandle);this.lateralus.update(a)}},initialize:function(){e.initialize.apply(this,arguments),this.syncContainerToTimelineLength(),this.$scrubberHandle.dragon({within:this.$scrubberWrapper})},deferredInitialize:function(){this.resizeScrubberGuide()},render:function(){this.syncContainerToTimelineLength(),this.syncHandleToTimelineLength()},syncContainerToTimelineLength:function(){var a=this.lateralus.model.get("timelineDuration")*(c.PIXELS_PER_SECOND/1e3)*this.lateralus.model.get("timelineScale");this.$scrubberWrapper.width(a+this.$scrubberHandle.width())},syncHandleToTimelineLength:function(){var a=this.lateralus.getLastPositionUpdated()*this.lateralus.model.get("timelineDuration"),b=a*(c.PIXELS_PER_SECOND/1e3)*this.lateralus.model.get("timelineScale");this.$scrubberHandle.css("left",b)},resizeScrubberGuide:function(){var a=this.collectOne("timelineWrapperHeight"),b=parseInt(this.$scrubberWrapper.css("borderBottomWidth"),10);this.$scrubberGuide.css("height",a-this.$el.height()+b)}});return f}),define("rekapi-timeline.component.scrubber/main",["lateralus","./model","./view","text!./template.mustache"],function(a,b,c,d){"use strict";var e=a.Component,f=e.extend({name:"scrubber",Model:b,View:c,template:d});return f}),define("rekapi-timeline.component.scrubber",["rekapi-timeline.component.scrubber/main"],function(a){return a}),define("rekapi-timeline.component.animation-tracks/model",["lateralus"],function(a){"use strict";var b=a.Component.Model,c=b.prototype,d=b.extend({initialize:function(){c.initialize.apply(this,arguments)}});return d}),define("text!rekapi-timeline.component.animation-tracks/template.mustache",[],function(){return""}),define("rekapi-timeline.component.actor-tracks/model",["lateralus"],function(a){"use strict";var b=a.Component.Model,c=b.prototype,d=b.extend({initialize:function(){c.initialize.apply(this,arguments)}});return d}),define("text!rekapi-timeline.component.actor-tracks/template.mustache",[],function(){return""}),define("rekapi-timeline.component.keyframe-property-track/model",["lateralus"],function(a){"use strict";var b=a.Component.Model,c=b.prototype,d=b.extend({defaults:{trackName:""},initialize:function(){c.initialize.apply(this,arguments)}});return d}),define("text!rekapi-timeline.component.keyframe-property-track/template.mustache",[],function(){return""}),define("rekapi-timeline.component.keyframe-property/model",["lateralus"],function(a){"use strict";var b=a.Component.Model,c=b.prototype,d=b.extend({initialize:function(){c.initialize.apply(this,arguments)}});return d}),define("text!rekapi-timeline.component.keyframe-property/template.mustache",[],function(){return'<div class="$handle keyframe-property" data-name="{{keyframeProperty.name}}" >&nbsp;</div>\n'}),define("rekapi-timeline.component.keyframe-property/view",["lateralus","text!./template.mustache","rekapi-timeline/constant"],function(a,b,c){"use strict";var d=a.Component.View,e=d.prototype,f=d.extend({template:b,events:{"mousedown .keyframe-property":function(){this.activate()},drag:function(){this.updateKeyframeProperty()}},modelEvents:{change:function(){this.render()},destroy:function(){this.dispose()}},lateralusEvents:{"rekapi:removeKeyframeProperty":function(a,b){var c=this.model.get("nextProperty");c&&c.id===b.id&&this.activate()},"change:timelineScale":function(){this.render()},userFocusedKeyframeProperty:function(){this.setActiveClass(!1)}},initialize:function(){e.initialize.apply(this,arguments),this.render()},deferredInitialize:function(){this.$el.dragon({within:this.$el.parent()}),this.doImmediatelyFocus&&this.activate()},render:function(){var a=this.$el.data("dragon");if(!a||!a.isDragging){var b=c.PIXELS_PER_SECOND*this.model.get("millisecond")/1e3*this.lateralus.model.get("timelineScale");this.$el.css({left:b})}},activate:function(){this.emit("userFocusedKeyframeProperty",this),this.setActiveClass(!0)},setActiveClass:function(a){this.$handle[a?"addClass":"removeClass"]("active")},updateKeyframeProperty:function(){var a=this.collectOne("timelineMillisecondForHandle",this.$el);this.model.set("millisecond",Math.round(a)),this.lateralus.update()}});return f}),define("rekapi-timeline.component.keyframe-property/main",["lateralus","./model","./view","text!./template.mustache"],function(a,b,c,d){"use strict";var e=a.Component,f=e.extend({name:"keyframe-property",Model:b,View:c,template:d});return f}),define("rekapi-timeline.component.keyframe-property",["rekapi-timeline.component.keyframe-property/main"],function(a){return a}),define("rekapi-timeline.component.keyframe-property-track/view",["lateralus","text!./template.mustache","rekapi-timeline.component.keyframe-property"],function(a,b,c){"use strict";var d=a.Component.View,e=d.prototype,f=d.extend({template:b,lateralusEvents:{keyframePropertyAdded:function(a){a.get("name")===this.model.get("trackName")&&this.addKeyframePropertyComponent(a,!0)}},initialize:function(){e.initialize.apply(this,arguments),this.keyframePropertyComponents=[];var a=this.model.get("trackName");this.$el.attr("data-track-name",a),this.actorModel.keyframePropertyCollection.where({name:a}).forEach(function(a){this.addKeyframePropertyComponent(a,!1)}.bind(this))},addKeyframePropertyComponent:function(a,b){var d=this.addComponent(c,{model:a,doImmediatelyFocus:!!b});this.$el.append(d.view.$el),this.keyframePropertyComponents.push(d)}});return f}),define("rekapi-timeline.component.keyframe-property-track/main",["lateralus","./model","./view","text!./template.mustache"],function(a,b,c,d){"use strict";var e=a.Component,f=e.extend({name:"keyframe-property-track",Model:b,View:c,template:d});return f}),define("rekapi-timeline.component.keyframe-property-track",["rekapi-timeline.component.keyframe-property-track/main"],function(a){return a}),define("rekapi-timeline.component.actor-tracks/view",["lateralus","text!./template.mustache","rekapi-timeline.component.keyframe-property-track"],function(a,b,c){"use strict";var d=a.Component.View,e=d.prototype,f=d.extend({template:b,modelEvents:{keyframePropertyTrackAdded:function(a){this.addKeyframePropertyTrackComponent(a)}},initialize:function(){e.initialize.apply(this,arguments),this.keyframePropertyTrackComponents=[],this.model.getTrackNames().forEach(this.addKeyframePropertyTrackComponent,this)},addKeyframePropertyTrackComponent:function(a){var b=this.addComponent(c,{actorModel:this.model},{modelAttributes:{trackName:a}});this.keyframePropertyTrackComponents.push(b),this.$el.append(b.view.$el)}});return f}),define("rekapi-timeline.component.actor-tracks/main",["lateralus","./model","./view","text!./template.mustache"],function(a,b,c,d){"use strict";var e=a.Component,f=e.extend({name:"actor-tracks",Model:b,View:c,template:d});return f}),define("rekapi-timeline.component.actor-tracks",["rekapi-timeline.component.actor-tracks/main"],function(a){return a}),define("rekapi-timeline.component.animation-tracks/view",["underscore","lateralus","text!./template.mustache","rekapi-timeline.component.actor-tracks"],function(a,b,c,d){"use strict";var e=b.Component.View,f=e.prototype,g=e.extend({template:c,lateralusEvents:{actorAdded:function(a){this.addActorComponent(a)}},initialize:function(){f.initialize.apply(this,arguments),this.actorTracksComponents=[],this.collectOne("actorCollection").each(this.addActorComponent,this)},addActorComponent:function(a){var b=this.addComponent(d,{model:a});this.actorTracksComponents.push(b),this.$el.append(b.view.$el)}});return g}),define("rekapi-timeline.component.animation-tracks/main",["lateralus","./model","./view","text!./template.mustache"],function(a,b,c,d){"use strict";var e=a.Component,f=e.extend({name:"animation-tracks",Model:b,View:c,template:d});return f}),define("rekapi-timeline.component.animation-tracks",["rekapi-timeline.component.animation-tracks/main"],function(a){return a}),define("rekapi-timeline.component.timeline/main",["lateralus","./model","./view","text!./template.mustache","rekapi-timeline.component.scrubber","rekapi-timeline.component.animation-tracks"],function(a,b,c,d,e,f){"use strict";var g=a.Component,h=g.extend({name:"timeline",Model:b,View:c,template:d,initialize:function(){this.scrubberComponent=this.addComponent(e,{el:this.view.$scrubber[0]}),this.animationTracksComponent=this.addComponent(f,{el:this.view.$animationTracks[0]})}});return h}),define("rekapi-timeline.component.timeline",["rekapi-timeline.component.timeline/main"],function(a){return a}),define("rekapi-timeline.component.details/model",["lateralus"],function(a){"use strict";var b=a.Component.Model,c=b.prototype,d=b.extend({initialize:function(){c.initialize.apply(this,arguments)}});return d}),define("text!rekapi-timeline.component.details/template.mustache",[],function(){return'<div class="$keyframePropertyDetail fill"></div>\n'}),define("rekapi-timeline.component.details/view",["lateralus","text!./template.mustache"],function(a,b){"use strict";var c=a.Component.View,d=c.prototype,e=c.extend({template:b,initialize:function(){d.initialize.apply(this,arguments)}});return e}),define("rekapi-timeline.component.keyframe-property-detail/model",["lateralus"],function(a){"use strict";var b=a.Component.Model,c=b.prototype,d=b.extend({initialize:function(){c.initialize.apply(this,arguments)}});return d}),define("text!rekapi-timeline.component.keyframe-property-detail/template.mustache",[],function(){return'<h1 class="$propertyName keyframe-property-name">Detail</h1>\n<div class="add-delete-wrapper">\n  <button class="icon-button add" title="Add a new keyframe to the current track">\n    <i class="glyphicon glyphicon-plus"></i>\n  </button>\n  <button class="icon-button delete" title="Remove the currently selected keyframe">\n    <i class="glyphicon glyphicon-minus"></i>\n  </button>\n</div>\n<label class="label-input-pair row keyframe-property-millisecond">\n  <p>Millisecond:</p>\n  <input class="$propertyMillisecond property-millisecond" type="number" value="" name="millisecond">\n</label>\n<label class="label-input-pair row keyframe-property-value">\n  <p>Value:</p>\n  <input class="$propertyValue property-value" type="text" value="" name="value">\n</label>\n<label class="label-input-pair row select-container keyframe-property-easing">\n  <p>Easing:</p>\n  <select class="$propertyEasing" name="easing"></select>\n</label>\n'}),define("rekapi-timeline.component.keyframe-property-detail/view",["underscore","lateralus","shifty","text!./template.mustache","rekapi-timeline/constant"],function(a,b,c,d,e){"use strict";var f=b.Component.View,g=f.prototype,h=f.extend({template:d,lateralusEvents:{userFocusedKeyframeProperty:function(b){this.keyframePropertyModel&&this.stopListening(this.keyframePropertyModel),this.keyframePropertyModel=b.model,this.listenTo(this.keyframePropertyModel,"change",this.render.bind(this));var d=[];a.each(c.prototype.formula,function(a,b){var c=document.createElement("option");c.innerHTML=b,d.push(c)},this),this.$propertyEasing.children().remove(),this.$propertyEasing.append(d).val(this.keyframePropertyModel.get("easing")),this.render()},"rekapi:removeKeyframeProperty":function(a,b){b.id===this.keyframePropertyModel.id&&(this.keyframePropertyModel=null,this.reset())}},events:{"change input":"onChangeInput","change select":"onChangeInput","click .add":function(){if(this.keyframePropertyModel){var a=this.keyframePropertyModel,b=a.getOwnerActor(),c=a.get("millisecond")+e.NEW_KEYFRAME_PROPERTY_BUFFER_MS,d={};d[a.get("name")]=a.get("value"),b.keyframe(c,d,a.get("easing"))}},"click .delete":function(){if(this.keyframePropertyModel){var a=this.keyframePropertyModel;a.getOwnerActor().removeKeyframeProperty(a.get("name"),a.get("millisecond"))}}},initialize:function(){g.initialize.apply(this,arguments),this.propertyNameDefaultText=this.$propertyName.text()},render:function(){this.$propertyName.text(this.keyframePropertyModel.get("name")),this.$propertyMillisecond.val(this.keyframePropertyModel.get("millisecond")),this.$propertyValue.val(this.keyframePropertyModel.get("value"))},onChangeInput:function(a){if(this.keyframePropertyModel){var b=$(a.target),c=b.val(),d=c==+c?+c:c;this.keyframePropertyModel.set(b.attr("name"),d),this.lateralus.update()}},reset:function(){this.$propertyName.text(this.propertyNameDefaultText),this.$propertyMillisecond.val(""),this.$propertyValue.val("")}});return h}),define("rekapi-timeline.component.keyframe-property-detail/main",["lateralus","./model","./view","text!./template.mustache"],function(a,b,c,d){"use strict";var e=a.Component,f=e.extend({name:"keyframe-property-detail",Model:b,View:c,template:d});return f}),define("rekapi-timeline.component.keyframe-property-detail",["rekapi-timeline.component.keyframe-property-detail/main"],function(a){return a}),define("rekapi-timeline.component.details/main",["lateralus","./model","./view","text!./template.mustache","rekapi-timeline.component.keyframe-property-detail"],function(a,b,c,d,e){"use strict";var f=a.Component,g=f.extend({name:"details",Model:b,View:c,template:d,initialize:function(){this.keyframePropertyDetailComponent=this.addComponent(e,{el:this.view.$keyframePropertyDetail[0]})}});return g}),define("rekapi-timeline.component.details",["rekapi-timeline.component.details/main"],function(a){return a}),define("rekapi-timeline.component.scrubber-detail/model",["lateralus"],function(a){"use strict";var b=a.Component.Model,c=b.prototype,d=b.extend({initialize:function(){c.initialize.apply(this,arguments)}});return d}),define("text!rekapi-timeline.component.scrubber-detail/template.mustache",[],function(){return'<label class="label-input-pair row scrubber-scale">\n  <p>Timeline zoom:</p>\n  <input type="number" class="$scrubberScale" value="{{initialZoom}}" min="0">\n</label>\n<p class="position-monitor">\n  <span class="$currentPosition"></span>ms / <span class="$animationLength"></span>ms\n</p>\n'}),define("rekapi-timeline.component.scrubber-detail/view",["underscore","lateralus","text!./template.mustache"],function(a,b,c){"use strict";var d=b.Component.View,e=d.prototype,f=d.extend({template:c,lateralusEvents:{"change:timelineDuration":function(){this.renderAnimationLength()},"rekapi:afterUpdate":function(){this.renderCurrentPosition()}},events:{"change .scrubber-scale input":function(){this.$scrubberScale[0].validity.valid&&this.lateralus.model.set("timelineScale",this.$scrubberScale.val()/100)}},initialize:function(){e.initialize.apply(this,arguments),this.renderAnimationLength()},getTemplateRenderData:function(){var b=e.getTemplateRenderData.apply(this,arguments);return a.extend(b,{initialZoom:100*this.lateralus.model.get("timelineScale")}),b},renderAnimationLength:function(){this.$animationLength.text(this.lateralus.model.get("timelineDuration"))},renderCurrentPosition:function(){var a=this.lateralus,b=a.getLastPositionUpdated()*a.model.get("timelineDuration");this.$currentPosition.text(Math.floor(b))}});return f}),define("rekapi-timeline.component.scrubber-detail/main",["lateralus","./model","./view","text!./template.mustache"],function(a,b,c,d){"use strict";var e=a.Component,f=e.extend({name:"scrubber-detail",Model:b,View:c,template:d});return f}),define("rekapi-timeline.component.scrubber-detail",["rekapi-timeline.component.scrubber-detail/main"],function(a){return a}),define("rekapi-timeline.component.container/main",["lateralus","./model","./view","text!./template.mustache","rekapi-timeline.component.control-bar","rekapi-timeline.component.timeline","rekapi-timeline.component.details","rekapi-timeline.component.scrubber-detail"],function(a,b,c,d,e,f,g,h){"use strict";var i=a.Component,j=i.extend({name:"container",Model:b,View:c,template:d,initialize:function(){this.controlBar=this.addComponent(e,{el:this.view.$controlBar[0]}),this.timelineComponent=this.addComponent(f,{el:this.view.$timeline[0]}),this.detailsComponent=this.addComponent(g,{el:this.view.$details[0]}),this.scrubberDetailComponent=this.addComponent(h,{el:this.view.$scrubberDetail[0]})}});return j}),define("rekapi-timeline.component.container",["rekapi-timeline.component.container/main"],function(a){return a}),define("rekapi-timeline/utils",["underscore"],function(a){"use strict";return{proxy:function(b,c,d){d=d||{};var e=d.blacklistedMethodNames||[],f=d.subject,g=a.difference(Object.keys(b.prototype),e),h=b.prototype,i=c.prototype;g.forEach(function(a){var b=h[a];i[a]=function(){var a=f?f.call(this):this;return b.apply(a,arguments)}},this)}}}),define("rekapi-timeline/model",["underscore","lateralus","rekapi-timeline/constant"],function(a,b,c){"use strict";var d=b.Model.extend({defaults:{timelineScale:c.DEFAULT_TIMELINE_SCALE,timelineDuration:0}});return d}),define("rekapi-timeline/models/keyframe-property",["underscore","backbone","lateralus","rekapi","rekapi-timeline/utils"],function(a,b,c,d,e){"use strict";var f=c.Component.Model,g=f.extend({defaults:{keyframeProperty:d.KeyframeProperty},lateralusEvents:{"rekapi:removeKeyframeProperty":function(a,b){b.id===this.id&&this.destroy()}},initialize:function(){this.attributes=this.attributes.keyframeProperty,this.id=this.attributes.id},set:function(a,c){if(b.Model.prototype.set.apply(this,arguments),a in this.attributes){var d={};d[a]=c,this.attributes.actor.modifyKeyframeProperty(this.attributes.name,this.attributes.millisecond,d)}},getOwnerActor:function(){return this.collection.actorModel},destroy:function(){this.trigger("destroy")}});return e.proxy(d.KeyframeProperty,g),g}),define("rekapi-timeline/collections/keyframe-property",["backbone","lateralus","rekapi-timeline/models/keyframe-property"],function(a,b,c){"use strict";var d=b.Component.Collection,e=d.extend({model:c,lateralusEvents:{"rekapi:addKeyframeProperty":function(a,b){b.actor.id===this.actorModel.id&&this.addKeyframeProperty(b)},"rekapi:removeKeyframeProperty":function(a,b){b.actor.id===this.actorModel.id&&this.removeKeyframeProperty(b)}},initialize:function(a,b){this.actorModel=b.actorModel},addKeyframeProperty:function(a){var b=this.initModel(c,{keyframeProperty:a});this.emit("keyframePropertyAdded",this.add(b))},removeKeyframeProperty:function(a){this.remove(a.id)}});return e}),define("rekapi-timeline/models/actor",["lateralus","rekapi","rekapi-timeline/collections/keyframe-property","rekapi-timeline/utils"],function(a,b,c,d){"use strict";var e=a.Component.Model,f=e.extend({defaults:{actor:b.Actor},lateralusEvents:{"rekapi:addKeyframePropertyTrack":function(a,b){b.actor.id===this.id&&this.addKeyframePropertyTrack(b.name)}},initialize:function(){this.attributes=this.attributes.actor,this.id=this.attributes.id,this.getTrackNames().forEach(this.addKeyframePropertyTrack,this);var a=this.initCollection(c,null,{actorModel:this});this.keyframePropertyCollection=a,this.getTrackNames().forEach(function(b){this.getPropertiesInTrack(b).forEach(a.addKeyframeProperty,a)},this)},addKeyframePropertyTrack:function(a){this.emit("keyframePropertyTrackAdded",a)}});return d.proxy(b.Actor,f,{subject:function(){return this.attributes}}),f}),define("rekapi-timeline/collections/actor",["underscore","backbone","lateralus","rekapi-timeline/models/actor"],function(a,b,c,d){"use strict";var e=c.Component.Collection,f=e.extend({model:d,provide:{actorCollection:function(){return this}},lateralusEvents:{"rekapi:addActor":function(a,b){this.addActor(b)}},initialize:function(){a.each(this.lateralus.getAllActors(),this.addActor,this)},addActor:function(a){var b=this.initModel(d,{actor:a});this.emit("actorAdded",this.add(b))}});return f}),define("rekapi-timeline/rekapi-timeline",["underscore","lateralus","rekapi","rekapi-timeline.component.container","rekapi-timeline/utils","rekapi-timeline/model","rekapi-timeline/collections/actor","jquery-dragon"],function(a,b,c,d,e,f,g){"use strict";var h=b.beget(function(c,e){b.apply(this,arguments),this.rekapi=e,this.model.set("timelineDuration",this.getAnimationLength()),this.getEventNames().forEach(function(b){this.rekapi.on(b,function(){this.emit.apply(this,["rekapi:"+b].concat(a.toArray(arguments)))}.bind(this))}.bind(this)),this.actorCollection=this.initCollection(g),this.containerComponent=this.addComponent(d,{el:c})},{Model:f});return a.extend(h.prototype,{lateralusEvents:{stopAnimation:function(){this.stop().update(0)},"rekapi:removeKeyframeProperty":function(){this.isPlaying()||a.defer(function(){var a=this.model.get("timelineDuration"),b=this.getLastMillisecondUpdated(),c=b>a?a:void 0;this.update(c)}.bind(this))},"rekapi:timelineModified":function(){if(!this.isPlaying()){var a=this.model.get("timelineDuration");this.getLastMillisecondUpdated()>a&&this.update(a)}this.model.set("timelineDuration",this.getAnimationLength())}},update:function(){var a=this.rekapi;try{a.update.apply(a,arguments)}catch(b){"TypeError"===b.name?this.warn("Keyframe property format mismatch detected"):this.warn(b)}return this.rekapi},getLastMillisecondUpdated:function(){return this.getLastPositionUpdated()*this.model.get("timelineDuration")}}),c.prototype.createTimeline=function(a){return new h(a,this)},e.proxy(c,h,{blacklistedMethodNames:["on","off","update"],subject:function(){return this.rekapi}}),h}),define("rekapi-timeline",["rekapi-timeline/rekapi-timeline"],function(a){return a})}();